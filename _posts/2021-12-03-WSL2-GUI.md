---
layout: post
title: "WSL2 GUI install"
date: 2012-05-22
excerpt: "wsl2 install GNOME desktop."
tags: [Linux, WSL2, Windows 10]
comments: true
---

##### WSL2 安装

```powershell
dism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart
dism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart
```

重新启动计算机

##### 下载安装

[wsl_update_x64.msi](https://wslstorestorage.blob.core.windows.net/wslblob/wsl_update_x64.msi)

```powershell
wsl --set-default-version 2
```

##### WSL2 配置

```bash
sudo sed -i 's/archive.ubuntu.com/mirrors.aliyun.com/g' /etc/apt/sources.list
sudo sed -i 's/security.ubuntu.com/mirrors.aliyun.com/g' /etc/apt/sources.list
sudo apt update

sudo apt-get install git -y
git config --global user.name "Your Name"
git config --global user.email "youremail@domain.com"

sudo apt update
sudo apt install mysql-server -y
mysql --version
sudo /etc/init.d/mysql start
sudo mysql_secure_installation

sudo apt update
sudo apt install redis-server -y
redis-server --version
sudo service redis-server start
sudo service redis-server stop

sudo apt install net-tools -y
sudo apt remove openjdk* -y
sudo apt install openjdk-8-jdk -y
sudo apt install maven -y
sudo vim /etc/maven/settings.xml
sudo apt install libreoffice -y
sudo apt install fonts-wqy-microhei ttf-wqy-zenhei -y
fc-list :lang=zh-cn
sudo locale-gen zh_CN.UTF-8
```

```bash
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh
# ExecStart=/usr/bin/dockerd -H fd:// -H tcp://0.0.0.0:2375 -H unix:///var/run/docker.sock --containerd=/run/containerd/containerd.sock
sudo vim /lib/systemd/system/docker.service
# DOCKER_OPTS="-H tcp://0.0.0.0:2375 -H unix:///var/run/docker.sock"
sudo vim /etc/default/docker
sudo service docker start
```

##### Windows Terminal 记住密码

```bash
sudo apt install sshpass -y
```

```powershell
wsl sshpass -p passwd ssh -oStrictHostKeyChecking=no -p 22 user@host_ip
```

##### 安装 Ubuntu GNOME desktop
```bash
# 由于Ubuntu GNOME desktop基于systemd
git clone https://hub.fastgit.org/DamionGans/ubuntu-wsl2-systemd-script.git
cd ubuntu-wsl2-systemd-script/
bash ubuntu-wsl2-systemd-script.sh
# 重启 WSL2
net stop LxssManager
net start LxssManager
# 安装 GNOME 桌面
sudo apt install ubuntu-desktop -y
# 安装 xrdp
sudo apt install xrdp -y
# 修改rdp默认端口3389
sudo vim /etc/xrdp/xrdp.ini
sudo systemctl start xrdp
# 如需打开防火墙端口
# sudo ufw allow 43389
```
